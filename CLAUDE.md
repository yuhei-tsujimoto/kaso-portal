# CLAUDE.md

このファイルは、このリポジトリでコードを扱う際ののガイダンスを提供します。  

## プロジェクト概要

朝霞キャンパスポータルは、東洋大学朝霞キャンパスの学生向けドキュメンテーションウェブサイトです。Zensical（静的サイトジェネレーター）で構築され、GitHub Pagesに自動デプロイされます。公開URL: <https://yuhei-tsujimoto.github.io/asaka-portal/>  

## 基本コマンド

### 開発環境のセットアップ

```bash  
# 仮想環境の作成と有効化
python3 -m venv .venv  
source .venv/bin/activate  

# 依存関係のインストール
pip install -r requirements.txt  
```  

### 開発ワークフロー

```bash  
# 開発サーバーの起動（変更時に自動リロード）
npm run dev  
# または直接実行:
source .venv/bin/activate && zensical serve  
# アクセス先: http://localhost:8000

# 静的サイトのビルド（site/ディレクトリに出力）
npm run build  
# または直接実行:
source .venv/bin/activate && zensical build  

# クリーンビルド（出力ディレクトリをクリア）
zensical build --clean  
```  

**注意:** Zensicalコマンドを実行する前に、必ず仮想環境を有効化してください。npmスクリプトは自動的にこれを処理します。  

## アーキテクチャ

### プロジェクト構造

```markdown  
asaka-portal/  
├── docs/                       # コンテンツソース（Markdownファイル）  
│   ├── index.md               # ホームページ（frontmatter付き）  
│   ├── 01_スケジュール/       # スケジュールカテゴリ（index.mdあり）  
│   ├── 02_履修-成績/          # 履修・成績カテゴリ  
│   ├── 03_学生生活/           # 学生生活カテゴリ  
│   ├── 04_進路-キャリア/      # 進路・キャリアカテゴリ  
│   ├── 05_各種申請/           # 各種申請カテゴリ  
│   └── 06_施設・設備/         # 施設・設備カテゴリ  
├── site/                       # ビルド出力（自動生成、gitには含まれない）  
├── .venv/                      # Python仮想環境（gitには含まれない）  
├── zensical.toml              # Zensical設定ファイル  
└── requirements.txt           # Python依存関係  
```  

### コンテンツ構成

- **コンテンツの場所:** すべてのドキュメントは`docs/`内にMarkdownファイルとして配置
- **カテゴリ構造:** 番号付きディレクトリ（例: `02_履修-成績/`）がコンテンツカテゴリを定義
- **カテゴリのindex.md規則:**
    - **01_スケジュールのみ** `index.md`を持つ（Googleカレンダーが埋め込まれたスケジュールホームページとして機能）
    - **その他のすべてのカテゴリ**（02, 03, 04, 05, 06）は`index.md`を持たない - トグル専用のナビゲーション項目として機能
    - 01_スケジュール以外のカテゴリに`index.md`を作成しないこと
- **ナビゲーション:** フォルダ構造とfrontmatterから自動生成。手動ナビゲーション設定は`zensical.toml`でコメントアウト済み
- **Frontmatter:** Markdownファイルでメタデータ（title、nav_order、layout）に使用

### Zensical設定

サイトは`zensical.toml`で設定されます:  

- **サイトメタデータ:** 名前、説明、著者、URL、著作権
- **言語:** 日本語（`ja`）
- **テーマ機能:** ナビゲーション、検索、コードハイライト、ダーク/ライトモード切替を含む
- **ナビゲーション:** ファイル構造から自動生成（手動ナビゲーション設定はコメントアウト済み）

有効化されている主な機能:  

- ハイライト付き全文検索（`search.highlight`）
- プリフェッチによる高速ナビゲーション
- コードのコピーボタンと注釈
- カスタムアイコン付きダーク/ライトモード切替

## デプロイ

### GitHub Actionsワークフロー

場所: `.github/workflows/docs.yml`  

- **トリガー:** `main`/`master`ブランチへのプッシュ、または手動ワークフロー実行
- **処理:** Python依存関係のインストール → `zensical build --clean` → GitHub Pagesへデプロイ
- **出力:** `github-pages`環境にデプロイ

### 手動デプロイ

デプロイはmainブランチへのプッシュで自動実行されます。手動でトリガーするには:  

1. GitHub Actionsタブに移動
2. 「Documentation」ワークフローを選択
3. 「Run workflow」をクリック

## コンテンツ開発

### 新規ページの追加

1. `docs/`配下の適切なカテゴリディレクトリにMarkdownファイルを作成
2. 必要に応じてtitleやnav_orderを含むfrontmatterを追加
3. Zensicalが自動的にナビゲーションに含める

### コンテンツスタイルガイドライン

#### 見出し階層

- **レベル1見出し（`#`）**: ページタイトル専用
    - `title` frontmatterフィールドで定義し、先頭に関連する絵文字を1つ付ける
    - 例: `title: 💼 アルバイト` または `title: 🌍 英語単位認定`
    - ページ内容を視覚的に表す絵文字を選択
    - ナビゲーションメニューとページヘッダーに表示される

- **レベル2見出し（`##`）**: ページコンテンツを大きく分割する主要セクション
    - **絵文字を含めない** - クリーンで意味的に保つ
    - ページ内の主要な概念的区分に使用
    - 例: `## 申請手続き` または `## 利用方法`

- **レベル3見出し（`###`）**: 標準的なサブセクション見出し（最も一般的に使用）
    - 常に先頭に関連する絵文字を1つ付ける
    - 例: `### 📅 更新時期` または `### 📝 申請方法`
    - サブセクション内容を視覚的に表す絵文字を選択

#### その他のスタイル規則

- **メニューカテゴリタイトル（frontmatterの`parent`）**: 絵文字を含めない
    - 例: `parent: 学生生活` または `parent: 履修・成績`
    - すべてのカテゴリでカテゴリ名をクリーンかつ一貫して保つ

### サイト設定の変更

`zensical.toml`を編集して以下を変更:  

- サイトメタデータ（名前、説明、URL）
- テーマ機能（ナビゲーション、検索など）
- カラースキームオプション
- カスタムナビゲーション構造（現在は自動生成）

### 検索機能

サイトは、ユーザーが情報を見つけるための主要な方法として全文検索機能を備えています。ホームページではこの機能を目立つように強調しています。コンテンツを追加する際は、見つけやすさを向上させるため、明確で検索可能なキーワードを使用してください。  

## 依存関係

- **Zensical:** 0.0.9（静的サイトジェネレーター）
- **Python:** 3.x必須
- **主要なPythonパッケージ:** markdown、pygments、pymdown-extensions（`requirements.txt`を参照）

## デプロイURL

本番サイト: <https://yuhei-tsujimoto.github.io/asaka-portal/>  
